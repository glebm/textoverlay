{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///bundle.min.js","webpack:///webpack/bootstrap 661454eb6330efc3ef7d","webpack:///./src/textoverlay.js"],"names":["root","factory","exports","module","define","amd","self","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_classCallCheck","instance","Constructor","TypeError","setStyle","element","style","keys","forEach","key","setProperty","value","_createClass","defineProperties","target","props","length","descriptor","writable","protoProps","staticProps","css","wrapper","box-sizing","overflow","overlay","border-color","border-style","color","position","white-space","word-wrap","width","textarea","background","outline","height","margin","properties","Textoverlay","strategies","_this","parentElement","Error","textareaStyle","window","getComputedStyle","createWrapper","createOverlay","textareaStyleWas","getPropertyValue","handleInput","bind","handleScroll","handleResize","addEventListener","observer","MutationObserver","observe","attributes","attributeFilter","wrapperDisplay","display","render","document","createElement","className","insertBefore","appendChild","copyTextareaStyle","removeEventListener","disconnect","remove","arguments","undefined","update","sync","_this2","firstChild","removeChild","computeOverlayNodes","node","top","scrollTop","reduce","ns","strategy","highlight","Array","concat","apply","map","nodeType","Node","TEXT_NODE","text","textContent","resp","prevIndex","match","lastIndex","exec","push","createTextNode","slice","str","span","cloneNode","_this3","default"],"mappings":"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","file":"bundle.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Textoverlay\"] = factory();\n\telse\n\t\troot[\"Textoverlay\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Textoverlay\"] = factory();\n\telse\n\t\troot[\"Textoverlay\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * textoverlay.js - Simple decorator for textarea elements\n *\n * @author Yuku Takahashi <taka84u9@gmil.com>\n * \n */\n\nvar css = {\n  wrapper: {\n    \"box-sizing\": \"border-box\",\n    overflow: \"hidden\"\n  },\n  overlay: {\n    \"box-sizing\": \"border-box\",\n    \"border-color\": \"transparent\",\n    \"border-style\": \"solid\",\n    color: \"transparent\",\n    position: \"absolute\",\n    \"white-space\": \"pre-wrap\",\n    \"word-wrap\": \"break-word\",\n    overflow: \"hidden\",\n    width: \"100%\"\n  },\n  textarea: {\n    background: \"transparent\",\n    \"box-sizing\": \"border-box\",\n    outline: \"none\",\n    position: \"relative\",\n    height: \"100%\",\n    width: \"100%\",\n    margin: \"0px\"\n  }\n};\n\n// Firefox does not provide shorthand properties in getComputedStyle, so we use the expanded ones here.\nvar properties = {\n  wrapper: [\"background-attachment\", \"background-blend-mode\", \"background-clip\", \"background-color\", \"background-image\", \"background-origin\", \"background-position\", \"background-position-x\", \"background-position-y\", \"background-repeat\", \"background-size\", \"display\", \"margin-top\", \"margin-right\", \"margin-bottom\", \"margin-left\"],\n  overlay: [\"font-family\", \"font-size\", \"font-weight\", \"line-height\", \"padding-top\", \"padding-right\", \"padding-bottom\", \"padding-left\", \"border-top-width\", \"border-right-width\", \"border-bottom-width\", \"border-left-width\"]\n};\n\nvar Textoverlay = function () {\n  function Textoverlay(textarea, strategies) {\n    var _this = this;\n\n    _classCallCheck(this, Textoverlay);\n\n    if (!textarea.parentElement) {\n      throw new Error(\"textarea must be in the DOM tree\");\n    }\n    this.textarea = textarea;\n    this.textareaStyle = window.getComputedStyle(textarea);\n    this.createWrapper();\n    this.createOverlay();\n\n    this.textareaStyleWas = {};\n    Object.keys(css.textarea).forEach(function (key) {\n      _this.textareaStyleWas[key] = _this.textarea.style.getPropertyValue(key);\n    });\n    setStyle(this.textarea, css.textarea);\n\n    this.strategies = strategies;\n\n    this.handleInput = this.handleInput.bind(this);\n    this.handleScroll = this.handleScroll.bind(this);\n    this.handleResize = this.handleResize.bind(this);\n    this.textarea.addEventListener(\"input\", this.handleInput);\n    this.textarea.addEventListener(\"scroll\", this.handleScroll);\n    this.observer = new MutationObserver(this.handleResize);\n    this.observer.observe(this.textarea, {\n      attributes: true,\n      attributeFilter: [\"style\"]\n    });\n\n    this.wrapperDisplay = this.wrapper.style.display;\n    this.render();\n  }\n\n  /**\n   * @protected\n   */\n\n\n  _createClass(Textoverlay, [{\n    key: \"createWrapper\",\n    value: function createWrapper() {\n      this.wrapper = document.createElement(\"div\");\n      this.wrapper.className = \"textoverlay-wrapper\";\n      setStyle(this.wrapper, css.wrapper);\n      this.wrapper.style.position = this.textareaStyle.position === \"static\" ? \"relative\" : this.textareaStyle.position;\n      var parentElement = this.textarea.parentElement;\n      parentElement.insertBefore(this.wrapper, this.textarea);\n      this.wrapper.appendChild(this.textarea);\n    }\n\n    /**\n     * @protected\n     */\n\n  }, {\n    key: \"createOverlay\",\n    value: function createOverlay() {\n      this.overlay = document.createElement(\"div\");\n      this.overlay.className = \"textoverlay\";\n      setStyle(this.overlay, css.overlay);\n      this.copyTextareaStyle(this.overlay, properties.overlay);\n      this.wrapper.insertBefore(this.overlay, this.textarea);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.textarea.removeEventListener(\"input\", this.handleInput);\n      this.textarea.removeEventListener(\"scroll\", this.handleScroll);\n      this.observer.disconnect();\n      this.overlay.remove();\n      setStyle(this.textarea, this.textareaStyleWas);\n      var parentElement = this.wrapper.parentElement;\n      if (parentElement) {\n        parentElement.insertBefore(this.textarea, this.wrapper);\n        this.wrapper.remove();\n      }\n    }\n\n    /**\n     * Public API to update and sync textoverlay\n     */\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var skipUpdate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!skipUpdate) {\n        this.update();\n      }\n      this.sync();\n    }\n\n    /**\n     * Update contents of textoverlay\n     *\n     * @private\n     */\n\n  }, {\n    key: \"update\",\n    value: function update() {\n      var _this2 = this;\n\n      // Remove all child nodes from overlay.\n      while (this.overlay.firstChild) {\n        this.overlay.removeChild(this.overlay.firstChild);\n      }\n\n      this.computeOverlayNodes().forEach(function (node) {\n        return _this2.overlay.appendChild(node);\n      });\n    }\n\n    /**\n     * Sync scroll and size of textarea\n     *\n     * @private\n     */\n\n  }, {\n    key: \"sync\",\n    value: function sync() {\n      this.overlay.style.top = -this.textarea.scrollTop + \"px\";\n      var props = this.wrapperDisplay === \"block\" ? [\"height\"] : [\"height\", \"width\"];\n      this.copyTextareaStyle(this.wrapper, props);\n    }\n\n    /**\n     * @private\n     */\n\n  }, {\n    key: \"computeOverlayNodes\",\n    value: function computeOverlayNodes() {\n      return this.strategies.reduce(function (ns, strategy) {\n        var highlight = document.createElement(\"span\");\n        setStyle(highlight, strategy.css);\n        return Array.prototype.concat.apply([], ns.map(function (node) {\n          if (node.nodeType != Node.TEXT_NODE) {\n            return node;\n          }\n          var text = node.textContent;\n          var resp = [];\n          while (true) {\n            var prevIndex = strategy.match.lastIndex;\n            var _match = strategy.match.exec(text);\n            if (!_match) {\n              resp.push(document.createTextNode(text.slice(prevIndex)));\n              break;\n            }\n            var str = _match[0];\n            resp.push(document.createTextNode(text.slice(prevIndex, strategy.match.lastIndex - str.length)));\n            var span = highlight.cloneNode();\n            span.textContent = str;\n            resp.push(span);\n          }\n          return resp;\n        }));\n      }, [document.createTextNode(this.textarea.value)]);\n    }\n  }, {\n    key: \"handleInput\",\n    value: function handleInput() {\n      this.render();\n    }\n  }, {\n    key: \"handleScroll\",\n    value: function handleScroll() {\n      this.render(true);\n    }\n  }, {\n    key: \"handleResize\",\n    value: function handleResize() {\n      this.render(true);\n    }\n\n    /**\n     * @private\n     */\n\n  }, {\n    key: \"copyTextareaStyle\",\n    value: function copyTextareaStyle(target, keys) {\n      var _this3 = this;\n\n      keys.forEach(function (key) {\n        target.style.setProperty(key, _this3.textareaStyle.getPropertyValue(key));\n      });\n    }\n  }]);\n\n  return Textoverlay;\n}();\n\n/**\n * Set style to the element.\n */\n\n\nexports.default = Textoverlay;\nfunction setStyle(element, style) {\n  Object.keys(style).forEach(function (key) {\n    element.style.setProperty(key, style[key]);\n  });\n}\n\n/***/ })\n/******/ ])[\"default\"];\n});\n\n\n// WEBPACK FOOTER //\n// bundle.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 661454eb6330efc3ef7d","/**\n * textoverlay.js - Simple decorator for textarea elements\n *\n * @author Yuku Takahashi <taka84u9@gmil.com>\n * @flow\n */\n\nconst css = {\n  wrapper: {\n    \"box-sizing\": \"border-box\",\n    overflow: \"hidden\",\n  },\n  overlay: {\n    \"box-sizing\": \"border-box\",\n    \"border-color\": \"transparent\",\n    \"border-style\": \"solid\",\n    color: \"transparent\",\n    position: \"absolute\",\n    \"white-space\": \"pre-wrap\",\n    \"word-wrap\": \"break-word\",\n    overflow: \"hidden\",\n    width: \"100%\",\n  },\n  textarea: {\n    background: \"transparent\",\n    \"box-sizing\": \"border-box\",\n    outline: \"none\",\n    position: \"relative\",\n    height: \"100%\",\n    width: \"100%\",\n    margin: \"0px\",\n  },\n};\n\n// Firefox does not provide shorthand properties in getComputedStyle, so we use the expanded ones here.\nconst properties = {\n  wrapper: [\n    \"background-attachment\",\n    \"background-blend-mode\",\n    \"background-clip\",\n    \"background-color\",\n    \"background-image\",\n    \"background-origin\",\n    \"background-position\",\n    \"background-position-x\",\n    \"background-position-y\",\n    \"background-repeat\",\n    \"background-size\",\n    \"display\",\n    \"margin-top\",\n    \"margin-right\",\n    \"margin-bottom\",\n    \"margin-left\",\n  ],\n  overlay: [\n    \"font-family\",\n    \"font-size\",\n    \"font-weight\",\n    \"line-height\",\n    \"padding-top\",\n    \"padding-right\",\n    \"padding-bottom\",\n    \"padding-left\",\n    \"border-top-width\",\n    \"border-right-width\",\n    \"border-bottom-width\",\n    \"border-left-width\",\n  ],\n};\n\nexport type Strategy = {\n  match: RegExp;\n  css: { [string]: string };\n};\n\nexport default class Textoverlay {\n  strategies: Strategy[];\n  observer: MutationObserver;\n  wrapperDisplay: string;\n\n  overlay: HTMLDivElement;\n  textarea: HTMLTextAreaElement;\n  textareaStyle: CSSStyleDeclaration;\n  textareaStyleWas: { [string]: string };\n  wrapper: HTMLDivElement;\n\n  handleInput: () => void;\n  handleResize: () => void;\n  handleScroll: () => void;\n\n  constructor(textarea: HTMLTextAreaElement, strategies: Strategy[]) {\n    if (!textarea.parentElement) {\n      throw new Error(\"textarea must be in the DOM tree\");\n    }\n    this.textarea = textarea;\n    this.textareaStyle = window.getComputedStyle(textarea);\n    this.createWrapper();\n    this.createOverlay();\n\n    this.textareaStyleWas = {};\n    Object.keys(css.textarea).forEach(key => {\n      this.textareaStyleWas[key] = this.textarea.style.getPropertyValue(key);\n    });\n    setStyle(this.textarea, css.textarea);\n\n    this.strategies = strategies;\n\n    this.handleInput = this.handleInput.bind(this);\n    this.handleScroll = this.handleScroll.bind(this);\n    this.handleResize = this.handleResize.bind(this);\n    this.textarea.addEventListener(\"input\", this.handleInput);\n    this.textarea.addEventListener(\"scroll\", this.handleScroll);\n    this.observer = new MutationObserver(this.handleResize);\n    this.observer.observe(this.textarea, {\n      attributes: true,\n      attributeFilter: [\"style\"],\n    });\n\n    this.wrapperDisplay = this.wrapper.style.display;\n    this.render();\n  }\n\n  /**\n   * @protected\n   */\n  createWrapper() {\n    this.wrapper = document.createElement(\"div\");\n    this.wrapper.className = \"textoverlay-wrapper\";\n    setStyle(this.wrapper, css.wrapper);\n    this.wrapper.style.position =\n        this.textareaStyle.position === \"static\" ? \"relative\" : this.textareaStyle.position;\n    const parentElement: Element = (this.textarea.parentElement: any);\n    parentElement.insertBefore(this.wrapper, this.textarea);\n    this.wrapper.appendChild(this.textarea);\n  }\n\n  /**\n   * @protected\n   */\n  createOverlay() {\n    this.overlay = document.createElement(\"div\");\n    this.overlay.className = \"textoverlay\";\n    setStyle(this.overlay, css.overlay);\n    this.copyTextareaStyle(this.overlay, properties.overlay);\n    this.wrapper.insertBefore(this.overlay, this.textarea);\n  }\n\n  destroy() {\n    this.textarea.removeEventListener(\"input\", this.handleInput);\n    this.textarea.removeEventListener(\"scroll\", this.handleScroll);\n    this.observer.disconnect();\n    this.overlay.remove();\n    setStyle(this.textarea, this.textareaStyleWas);\n    const parentElement = this.wrapper.parentElement;\n    if (parentElement) {\n      parentElement.insertBefore(this.textarea, this.wrapper);\n      this.wrapper.remove();\n    }\n  }\n\n  /**\n   * Public API to update and sync textoverlay\n   */\n  render(skipUpdate: boolean = false) {\n    if (!skipUpdate) {\n      this.update();\n    }\n    this.sync();\n  }\n\n  /**\n   * Update contents of textoverlay\n   *\n   * @private\n   */\n  update() {\n    // Remove all child nodes from overlay.\n    while (this.overlay.firstChild) {\n      this.overlay.removeChild(this.overlay.firstChild);\n    }\n\n    this.computeOverlayNodes().forEach(node => this.overlay.appendChild(node));\n  }\n\n  /**\n   * Sync scroll and size of textarea\n   *\n   * @private\n   */\n  sync() {\n    this.overlay.style.top = `${-this.textarea.scrollTop}px`;\n    const props = this.wrapperDisplay === \"block\" ? [\"height\"] : [\"height\", \"width\"];\n    this.copyTextareaStyle(this.wrapper, props);\n  }\n\n  /**\n   * @private\n   */\n  computeOverlayNodes(): Node[] {\n    return this.strategies.reduce((ns: Node[], strategy) => {\n      const highlight = document.createElement(\"span\");\n      setStyle(highlight, strategy.css);\n      return Array.prototype.concat.apply([], ns.map(node => {\n        if (node.nodeType != Node.TEXT_NODE) { return node; }\n        const text = node.textContent;\n        const resp = [];\n        while (true) {\n          const prevIndex = strategy.match.lastIndex;\n          const match = strategy.match.exec(text);\n          if (!match) {\n            resp.push(document.createTextNode(text.slice(prevIndex)));\n            break;\n          }\n          const str = match[0];\n          resp.push(document.createTextNode(text.slice(prevIndex, strategy.match.lastIndex - str.length)));\n          const span = highlight.cloneNode();\n          span.textContent = str;\n          resp.push(span);\n        }\n        return resp;\n      }));\n    }, [document.createTextNode(this.textarea.value)]);\n  }\n\n  handleInput() {\n    this.render();\n  }\n\n  handleScroll() {\n    this.render(true);\n  }\n\n  handleResize() {\n    this.render(true);\n  }\n\n  /**\n   * @private\n   */\n  copyTextareaStyle(target: HTMLElement, keys: string[]) {\n    keys.forEach(key => {\n      target.style.setProperty(key, this.textareaStyle.getPropertyValue(key));\n    });\n  }\n}\n\n/**\n * Set style to the element.\n */\nfunction setStyle(element: HTMLElement, style: { [string]: string }) {\n  Object.keys(style).forEach(key => {\n    element.style.setProperty(key, style[key]);\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/textoverlay.js"],"sourceRoot":""}